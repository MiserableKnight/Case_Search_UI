# 历史问题查询系统使用指南

## 环境配置

### 系统要求
- 操作系统：Windows/Linux/MacOS
- Python版本：3.10
- 推荐浏览器：Chrome/Firefox/Edge最新版

### 安装步骤
1. **安装Anaconda**
   ```bash
   # 访问 https://www.anaconda.com/download 下载并安装

   # 验证安装
   conda --version
   ```

2. **创建虚拟环境**
   ```bash
   # 创建名为search的Python 3.10环境
   conda create -n search python=3.10

   # 激活环境
   conda activate search

   # 安装依赖
   pip install -r requirements.txt
   ```

3. **运行系统**
   ```bash
   # 确保在search环境中
   python wsgi.py
   ```

## 使用说明

### 1. 数据源选择
- 系统支持四种数据源：
  - 快响信息
  - 工程文件
  - 手册
  - 故障报告
- 在页面顶部选择要搜索的数据源

### 2. 搜索功能
#### 关键字搜索
- 支持多关键字组合搜索
- 关键字之间用逗号分隔（中英文逗号均可）
- 示例：`电机,报警`或`电机，转速，故障`
- 支持AND/OR逻辑切换
  - AND：所有关键字都必须匹配
  - OR：任一关键字匹配即可

#### 高级搜索
- 支持指定列搜索
  - 可选择特定字段进行精确搜索
  - 支持多列组合搜索
- 支持日期范围筛选
  - 可按年月日筛选时间范围
- 支持反向过滤（排除特定条件）
  - 勾选"反向过滤"选项可排除包含关键字的结果

#### 相似度搜索
- 选择参考案例后点击"相似搜索"
- 系统会自动查找相似的历史案例
- 支持批量相似度计算
- 相似度结果按匹配程度排序
- 建议配合关键字过滤使用

### 3. 数据导入
- 支持Excel格式文件（.xls, .xlsx）
- 导入步骤：
  1. 点击"导入数据"按钮
  2. 选择Excel文件
  3. 预览数据量变化并确认
  4. 等待导入完成（支持进度跟踪）
  5. 导入完成后会显示导入统计信息
- 注意：
  - 当前仅支持快响数据导入
  - 系统会自动检测并处理重复数据
  - 导入过程中请勿关闭浏览器

### 4. 数据导出
- 支持将搜索结果导出为Excel
- 可选择全部导出或仅导出选中项
- 导出文件会自动命名并下载到本地

### 5. 数据分析
- 选中需要分析的数据
- 点击"数据分析"按钮
- 在新页面中查看分析结果
- 支持数据可视化展示
- 注意：建议单次选择数据不超过300条

### 6. 敏感词管理
- 仅限管理员使用
- 支持添加、删除和分类敏感词
- 敏感词会在数据展示时自动脱敏处理
- 敏感词分类：
  - 客户信息
  - 商业机密
  - 敏感地点
  - 其他

## 使用技巧
1. 搜索时多尝试不同的关键字组合
2. 使用反向过滤排除干扰信息
3. 对于复杂问题，建议先用关键字缩小范围，再用相似度搜索
4. 导出数据前先使用过滤功能减少数据量
5. 使用AND/OR逻辑切换提高搜索精度

## 常见问题解答
1. **搜索结果为空？**
   - 尝试减少关键字数量
   - 检查关键字拼写是否正确
   - 尝试使用OR逻辑替代AND逻辑

2. **导入数据失败？**
   - 确认Excel文件格式正确
   - 检查文件是否被其他程序占用
   - 确认网络连接稳定

3. **系统运行缓慢？**
   - 减少一次性处理的数据量
   - 关闭不必要的浏览器标签
   - 确保系统资源充足

## 注意事项
1. 首次使用请仔细阅读本指南
2. 注意数据安全，勿将敏感信息外传
3. 遇到问题及时反馈给管理员
4. 定期备份重要数据
