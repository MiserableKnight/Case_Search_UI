"""
数据清洗配置文件
包含航空公司名称标准化规则、机型清洗规则等数据清洗相关配置
"""

# 航空公司名称标准化规则
AIRLINE_REPLACE_RULES: list[tuple[list[str], str]] = [
    # 天骄航空
    (["天骄", "天骄航空", "天骄航空有限公司"], "天骄"),
    # 东方航空及其子公司
    (
        [
            "东航",
            "东方航空",
            "一二三航空",
            "一二三航空有限公司（东方航空）",
            "东航技术",
            "中国东方航空有限公司",
            "中国东方航空股份有限公司",
            "一二三航空有限公司（东航）",
            "一二三航空有限公司",
            "中国东方航空集团有限公司",
        ],
        "东航",
    ),
    # 江西航空
    (["江西航", "江西航空有限公司", "江西航空"], "江西航"),
    # 南方航空
    (
        [
            "南航",
            "南方航空",
            "中国南方航空有限公司",
            "中国南方航空股份有限公司",
        ],
        "南航",
    ),
    # 中国国际航空
    (["国航", "中国国航", "中国国际航空股份有限公司"], "国航"),
    # 成都航空
    (["成航", "成都航空", "成都航空有限公司"], "成航"),
    # 乌鲁木齐航空
    (["乌航", "乌鲁木齐航空", "乌鲁木齐航空有限责任公司"], "乌航"),
    # 华夏航空
    (["华夏", "华夏航空", "华夏航空股份有限公司"], "华夏"),
    # 金鹏航空
    (["金鹏", "金鹏航空"], "金鹏"),
    # 圆通货运航空
    (["圆通", "圆通货航", "圆通航空", "杭州圆通货运航空有限公司"], "圆通"),
    # 中飞通用航空
    (["中飞通", "中飞通航", "中飞通用航空有限责任公司"], "中飞通"),
    # 中原龙浩航空
    (["中原龙浩", "中原龙浩航空", "中原龙浩航空有限公司"], "中原龙浩"),
    # 上飞公司维修中心
    (["上飞公司维修中心"], "上飞公司维修中心"),
    # 广州飞机维修工程有限公司
    (["GAMECO", "广州飞机维修工程有限公司（GAMECO）"], "GAMECO"),
    # 翎亚航空
    (
        [
            "翎亚",
            "翎亚航空 PT TransNusa Aviation Mandiri",
            "TRANSNUSA AVIATION MANDIRI",
            "TransNusa",
        ],
        "翎亚",
    ),
    # 中国商用飞机有限责任公司
    (["中国商飞", "中国商用飞机有限责任公司"], "中国商飞"),
    # 北京飞机维修工程有限公司
    (["AMECO", "北京飞机维修工程有限公司"], "AMECO"),
    # 山东太古飞机工程有限公司
    (["山东太古", "山东太古飞机工程有限公司"], "山东太古"),
    # 上海科技宇航有限公司
    (["STARCO", "上海科技宇航有限公司 Shanghai Technologies Aerospace (STARCO)"], "STARCO"),
    # 中国飞机租赁集团控股有限公司
    (["中飞租", "中国飞机租赁集团控股有限公司"], "中飞租"),
    # 中国飞龙通用航空有限公司
    (["中国飞龙通航有限公司"], "飞龙"),
    # 老挝航空公司
    (["老挝航空公司"], "老航"),
    # 上海飞机客户服务有限公司（商飞快线）
    (["上海飞机客户服务有限公司"], "商飞快线"),
]

# 机型标准化规则（使用正则表达式）
AIRCRAFT_TYPE_PATTERNS: dict[str, str] = {
    r".*ARJ21.*": "ARJ21",
    r".*C919.*": "C919",
}

# 机型直接替换规则（明确列表，用于精确匹配）
# 优先级高于正则表达式规则
AIRCRAFT_REPLACE_RULES: list[tuple[list[str], str]] = [
    # ARJ21 系列机型
    (["ARJ21-700", "ARJ21-701", "ARJ-700", "ARJ21-700ER"], "ARJ21"),
    # C919 系列机型
    (["C919-STD", "C919-ER"], "C919"),
    # 可以继续添加其他机型的变体
]

# 空值变体替换规则
# 将各种形式的空值统一为"无"
# 包括：空字符串、字符串形式的 null/NaN/None、以及嵌入的 null/ 和 /null 等
NULL_VALUE_REPLACEMENTS: list[str] = [
    "",  # 空字符串
    "nan",  # 字符串 'nan'
    "None",  # 字符串 'None'
    "null",  # 字符串 'null'
    "NaN",  # 字符串 'NaN'
    "NULL",  # 字符串 'NULL'
]

# 空值嵌入模式清理规则
# 用于处理嵌入在字符串中间的空值标记，如 "null/123" 或 "123/null"
# 这些模式在清理后会导致空字符串，最终会被替换为"无"
NULL_EMBEDDED_PATTERNS: dict[str, str] = {
    "null/": "",  # 去除前缀 "null/"
    "/null": "",  # 去除后缀 "/null"
}
