# 历史问题查询系统

一个基于Flask开发的航空维修历史问题智能检索与分析系统，专门用于管理和分析C909等机型的维修技术文档。

## 🏗️ 项目架构

### 技术栈

- **后端**: Flask 2.3.3 + Python 3.10
- **前端**: Vue 2.6.14 + Element UI 2.15.13
- **数据存储**: Parquet文件（PyArrow 14.0.1）
- **机器学习**: scikit-learn 1.3.0（相似度计算）
- **中文处理**: jieba 0.42.1（中文分词）
- **任务调度**: APScheduler 3.10.4

### 目录结构

```
Case_Search_UI/
├── app/                          # 主应用目录
│   ├── api/                      # API路由
│   ├── core/                     # 核心功能
│   │   ├── data_processors/      # 数据处理器
│   │   └── [核心模块].py         # 脱敏、计算、敏感词管理等
│   ├── services/                 # 业务服务层
│   ├── static/                   # 静态资源
│   ├── templates/                # HTML模板
│   └── utils/                    # 工具函数
├── data/                         # 数据目录
│   ├── raw/                      # 原始数据（Parquet文件）
│   ├── processed/                # 处理后数据
│   ├── temp/                     # 临时文件
│   └── backup_data/              # 备份数据
├── scripts/                      # 运行脚本
└── logs/                         # 日志文件
```

## 🎯 核心功能

### 1. 多数据源支持

支持5种数据源的智能检索：

- **快响信息** (case.parquet)
- **工程文件** (engineering.parquet)  
- **手册** (manual.parquet)
- **故障报告** (faults.parquet)
- **部件拆换记录** (r_and_i_record.parquet)

### 2. 智能搜索

- **关键字搜索**: 支持中英文逗号分隔多关键字
- **高级搜索**: AND/OR逻辑组合、反向过滤、指定列搜索
- **相似度搜索**: 基于文本内容的智能相似案例匹配
- **机型筛选**: ARJ21、C919等机型过滤

### 3. 数据管理

- **数据导入**: 支持Excel(.xlsx/.xls)、CSV、Parquet格式
- **数据导出**: 搜索结果导出为Excel格式
- **数据备份**: 自动定时备份功能
- **敏感词管理**: 5类敏感词自动脱敏（组织机构、设备型号、地点、机号/MSN、其他）

### 4. 分析功能

- **选中数据分析**: 支持对搜索结果进行进一步分析
- **可视化展示**: 图表化数据展示
- **数据预览**: 导入前的数据预览确认

## 🚀 快速开始

### 环境要求

- Python 3.10
- 推荐浏览器：Chrome

### 安装步骤

1. **创建虚拟环境**
   
   ```bash
   conda create -n search python=3.10
   conda activate search
   ```

2. **安装依赖**
   
   ```bash
   pip install -r requirements.txt
   ```

3. **运行系统**
   
   ```bash
   # 开发环境
   python wsgi.py
   ```

# 或通过Windows脚本

scripts\run.bat

```
4. **访问系统**
浏览器访问: http://127.0.0.1:5000

## 📋 使用指南

### 基本搜索
1. 选择数据源（快响信息、工程文件等）
2. 输入搜索关键字（如："电机,报警"）
3. 设置搜索逻辑（AND/OR）
4. 点击搜索获取结果

### 高级搜索
- **指定列搜索**: 可选择特定字段进行精确搜索
- **日期范围**: 按年月日筛选时间范围
- **反向过滤**: 排除包含特定关键字的结果
- **机型筛选**: 选择特定机型数据

### 数据导入
1. 点击"导入数据"按钮
2. 选择Excel文件上传
3. 预览数据变化并确认
4. 等待导入完成（支持进度跟踪）

### 数据导出
- 支持全部导出或选中项导出
- 自动生成Excel文件下载

## 🔧 开发指南

### 配置文件
- **开发环境**: `app/config/development.py`
- **生产环境**: `app/config/production.py`
- **默认配置**: `app/config/default.py`

### API端点
- `POST /api/search` - 关键字搜索
- `POST /api/similarity_search` - 相似度搜索
- `POST /api/import/<source>/upload` - 文件上传
- `GET /api/sensitive_words` - 获取敏感词
- `POST /api/anonymize` - 数据脱敏

### 代码质量
```bash
# 代码格式化
black app/
isort app/

# 代码检查
flake8 app/
```

## ⚠️ 使用限制

- **浏览器存储**: 本地存储限制5-10MB
- **数据分析**: 建议单次选择数据不超过300条
- **文件上传**: 最大支持16MB文件
- **敏感词管理**: 仅限管理员使用

## 📊 性能指标

- **搜索响应**: <500ms（10000条数据内）
- **并发支持**: 200+并发用户
- **数据容量**: 支持百万级数据量
- **系统可用性**: ≥99.9%

## 🔄 版本历史

### v1.2.0.0（当前）

- 优化错误处理机制
- 增强系统稳定性
- 改进用户界面体验

### v1.1.9.x

- 重构项目架构
- 添加数据导入功能
- 支持相似度搜索

完整版本历史请查看 [CHANGELOG.md](docs/CHANGELOG.md)

## 📞 技术支持

- **使用指南**: [docs/GUIDE.md](docs/GUIDE.md)
- **问题反馈**: 联系系统管理员
- **数据备份**: 自动每日备份至`data/backup_data/`

---

**注意**: 本项目为内部工具系统，请遵守数据安全规定，勿将敏感信息外传。